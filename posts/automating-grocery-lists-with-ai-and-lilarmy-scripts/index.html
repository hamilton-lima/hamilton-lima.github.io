<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Automating Grocery Lists with AI and LilArmy Scripts - Hamilton Lima</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://hamiltonlima.comfavicon.png><link rel=canonical href=https://hamiltonlima.com/posts/automating-grocery-lists-with-ai-and-lilarmy-scripts/><link rel=stylesheet href=/css/style.min.381fd69187be1f5dde5031ac9014016e77965dbc38358cb065b6fede27b5861c.css><link rel=stylesheet href=/assets/css/extended.min.9729f28a5087b689b946e103d96abd63bfd37b1417effa251dbf798312e3fba5.css><meta property="og:title" content="Automating Grocery Lists with AI and LilArmy Scripts"><meta property="og:type" content="website"><meta property="og:url" content="https://hamiltonlima.com/posts/automating-grocery-lists-with-ai-and-lilarmy-scripts/"><meta name=twitter:card content="summary"><meta name=twitter:site content="@athanazio"><meta name=twitter:creator content="@athanazio"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel=stylesheet></head><body class="page frame page-blog-single"><div id=menu-main-mobile class=menu-main-mobile><ul class=menu><li class=menu-item-posts><a href=https://hamiltonlima.com/posts>Posts</a></li></ul></div><div id=wrapper class=wrapper><div class=header><a class=header-logo href=/>Hamilton Lima</a><div class=menu-main><ul><li class=menu-item-posts><a href=/posts><span>Posts</span></a></li></ul></div><div id=toggle-menu-main-mobile class=hamburger-trigger><button class=hamburger>Menu</button></div></div><div class=blog><div class=intro><h1>Automating Grocery Lists with AI and LilArmy Scripts<span class=dot>.</span></h1></div><div class=content><p>My Friend <a href=https://www.linkedin.com/in/deepeshhmehta/>Deepesh Mehta</a> asked me to build a feature in <a href=https://lilarmy.com>lilarmy</a> that he could use to manage his pantry inventory. My first reaction was &ldquo;Oh let&rsquo;s do some agent for that!&rdquo; I guess I am AI bias like everybody else&mldr; but after a little bit of reflection, and some conversation with Claudio and Blue, yeah I named my agents, Claudio is actually <a href=https://github.com/anthropics/claude-code>Claude Code</a> and Blue a <a href=https://openclaw.ai/>OpenClaw</a> that I talk using Telegram&mldr; But after the conversation I realized that what my friend needs is a deterministic behaviour: Define the expected state of the inventory, gather information of the current state and list what is missing, a.k.a. My grocery list.</p><p>That demand generated a new feature to lilarmy, scripts in the cards! on top of creating cards with annotations, tags, AI agents to auto tag, drawings, images, drawing inside the cards, cards inside cards, all of that, now you can also add Python scripts to the cards, awaiting for events to happen.</p><p>Oh almost forgot, now when you paste a JSON array in the lilarmy it will create a card of type database autodetecting the JSON columns and creating one card for each item in the array. For example, when you paste a JSON like this:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>[</span>
  <span class=p>{</span>
    <span class=nt>&#34;brand&#34;</span><span class=p>:</span> <span class=s2>&#34;TAZO&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wild Sweet Orange&#34;</span><span class=p>,</span>
    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;Herbal Tea&#34;</span><span class=p>,</span>
    <span class=nt>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>1</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;brand&#34;</span><span class=p>:</span> <span class=s2>&#34;Tetley&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Super Herbal Tea IMMUNE&#34;</span><span class=p>,</span>
    <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Lemon &amp; Echinacea with Zinc&#34;</span><span class=p>,</span>
    <span class=nt>&#34;size&#34;</span><span class=p>:</span> <span class=s2>&#34;40g&#34;</span><span class=p>,</span>
    <span class=nt>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>1</span>
  <span class=p>},</span>
  <span class=p>{</span>
    <span class=nt>&#34;brand&#34;</span><span class=p>:</span> <span class=s2>&#34;Twinings&#34;</span><span class=p>,</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Unknown variety&#34;</span><span class=p>,</span>
    <span class=nt>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>1</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></div><p>Lilarmy will automatically detect the columns (<code>brand</code>, <code>name</code>, <code>type</code>, <code>description</code>, <code>size</code>, <code>quantity</code>) and create individual cards for each item in a database view.</p><h2 id=gathering-inventory-data-from-images>Gathering inventory data from images</h2><p>I took a picture of my tea pantry and fed it to multiple AI providers to see how they would interpret the inventory:</p><p><img src=/images/2026/tea-pantry-full-inventory.png alt="Tea pantry full inventory">
<em>My tea pantry - the test subject for this experiment</em></p><h3 id=the-prompt>The prompt</h3><p>I used a simple prompt across all providers:</p><blockquote><p>Given the provided image, identify what is in it and generate a JSON file with the name of the product found and quantities</p></blockquote><h3 id=comparing-ai-providers>Comparing AI providers</h3><p>I tested Claude, Gemini, and OpenAI with the same image. Each one gave me a JSON array that I could paste directly into lilarmy:</p><p><img src=/images/2026/lilarmy-create-database-claude.png alt="Create database from Claude JSON">
<em>Claude detected 15 items with brand, type, and quantity fields</em></p><p><img src=/images/2026/lilarmy-create-database-gemini.png alt="Create database from Gemini JSON">
<em>Gemini also found 15 items with similar structure</em></p><p><img src=/images/2026/lilarmy-create-database-openai.png alt="Create database from OpenAI JSON">
<em>OpenAI detected 13 items with a simpler schema</em></p><p>The results were interesting - Claude and Gemini both detected 15 products while OpenAI found 13. The field detection also varied, Claude gave me brand, type, and quantity while OpenAI went minimal with just quantity. The fix was simple: reorganize the JSON so there is only one array of the products as a result.</p><p><img src=/images/2026/lilarmy-three-databases-comparison.png alt="Three databases side by side">
<em>All three inventories imported as database cards in lilarmy</em></p><h2 id=setting-up-the-automation>Setting up the automation</h2><p>Here&rsquo;s where the Python scripts come in. I wanted to automate the comparison between my &ldquo;perfect inventory&rdquo; (what I want to have) and the current state (what AI detected from a new photo).</p><h3 id=the-setup>The setup</h3><ol><li>Duplicated the Database from Claude and named it &ldquo;PERFECT INVENTORY&rdquo;</li><li>Created a new Card named &ldquo;INVENTORY READINGS&rdquo; with a Python script attached</li><li>Set the script to trigger on <code>on_child_added</code> event - so whenever I paste a new inventory, it runs automatically</li></ol><p><img src=/images/2026/lilarmy-duplicate-database-action.png alt="Duplicate database action">
<em>Using the duplicate action to create the reference inventory</em></p><h3 id=the-perfect-inventory>The perfect inventory</h3><p><img src=/images/2026/lilarmy-perfect-inventory-table.png alt="Perfect inventory table view">
<em>The table view shows all 15 items I want to keep in stock</em></p><h3 id=the-python-script>The Python script</h3><p>I asked Claudio to create the Python script that will: Read a newly created card of type database, will look for each of the cards in the &ldquo;PERFECT INVENTORY&rdquo; in the list of children cards of the newly created card, and the cards from &ldquo;PERFECT INVENTORY&rdquo; that are missing should be included in a list that should be inserted at the bottom of today&rsquo;s card with the title &ldquo;Grocery List&rdquo;.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>re</span>

<span class=k>def</span> <span class=nf>normalize_name</span><span class=p>(</span><span class=n>name</span><span class=p>):</span>
    <span class=c1># Remove content inside parentheses, strip whitespace, and lower case</span>
    <span class=n>name</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\([^)]*\)&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>name</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>

<span class=c1># Get the PERFECT INVENTORY card</span>
<span class=n>perfect_inventory</span> <span class=o>=</span> <span class=n>await</span> <span class=n>cards</span><span class=o>.</span><span class=n>get_by_name</span><span class=p>(</span><span class=s2>&#34;PERFECT INVENTORY&#34;</span><span class=p>)</span>

<span class=k>if</span> <span class=ow>not</span> <span class=n>perfect_inventory</span><span class=p>:</span>
    <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;PERFECT INVENTORY card not found&#34;</span><span class=p>)</span>
<span class=k>elif</span> <span class=ow>not</span> <span class=n>child</span><span class=p>:</span>
    <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;The &#39;child&#39; variable is missing.&#34;</span><span class=p>)</span>
<span class=k>else</span><span class=p>:</span>
    <span class=c1># Build lookup of current items (Normalized Name -&gt; Quantity)</span>
    <span class=n>current_items</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>child</span><span class=o>.</span><span class=n>children</span><span class=p>:</span>
        <span class=n>norm_name</span> <span class=o>=</span> <span class=n>normalize_name</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
        <span class=n>qty</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;quantity&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>current_items</span><span class=p>[</span><span class=n>norm_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>current_items</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>norm_name</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>qty</span>

    <span class=c1># Compare with perfect inventory</span>
    <span class=n>missing</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>perfect_inventory</span><span class=o>.</span><span class=n>children</span><span class=p>:</span>
        <span class=n>norm_item_name</span> <span class=o>=</span> <span class=n>normalize_name</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
        <span class=n>needed</span> <span class=o>=</span> <span class=n>item</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;quantity&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>have</span> <span class=o>=</span> <span class=n>current_items</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>norm_item_name</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>have</span> <span class=o>&lt;</span> <span class=n>needed</span><span class=p>:</span>
            <span class=n>missing</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;- {item.name}: need {needed - have}&#34;</span><span class=p>)</span>

    <span class=c1># Add to today&#39;s note</span>
    <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
        <span class=n>today_card</span> <span class=o>=</span> <span class=n>await</span> <span class=n>today</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
        <span class=n>grocery_list</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>## Grocery List</span><span class=se>\n</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>missing</span><span class=p>)</span>
        <span class=n>await</span> <span class=n>cards</span><span class=o>.</span><span class=n>append_content</span><span class=p>(</span><span class=n>today_card</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>grocery_list</span><span class=p>)</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Added {len(missing)} items to grocery list&#34;</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Inventory is complete! Nothing to buy.&#34;</span><span class=p>)</span>
</code></pre></div><p>The script uses a <code>normalize_name</code> function to handle variations in how different AI providers name the same product. &ldquo;Herbal Tea (assorted)&rdquo; and &ldquo;Herbal Tea&rdquo; should match.</p><h2 id=testing-it-out>Testing it out</h2><p>I did some changes to my fake tea inventory and took a new picture - removed some items to simulate running low:</p><p><img src=/images/2026/tea-pantry-missing-items.png alt="Tea pantry with missing items">
<em>The pantry after &ldquo;using&rdquo; some teas</em></p><p>Then I pasted the updated inventory JSON in the &ldquo;INVENTORY READINGS&rdquo; card and voil√†! The script detected the missing items and added them to my daily note:</p><p><img src=/images/2026/lilarmy-grocery-list-result.png alt="Grocery list result">
<em>The grocery list automatically generated in today&rsquo;s note</em></p><p>The script correctly identified the 5 missing teas: Chamomile & Lavender, Super Herbal Tea IMMUNE, Green Tea ANTIOX, Super Herbal Tea BOOST, and Vivez bonheur.</p><h2 id=what-i-learned>What I learned</h2><p>This was a fun exercise in combining AI capabilities with deterministic automation. The AI does the heavy lifting of recognizing products from images, but the comparison logic is a simple Python script - no hallucinations, no creative interpretations, just straightforward list comparison.</p><p>The scripts feature in lilarmy runs Python via <a href=https://pyodide.org>Pyodide</a> (Python in WebAssembly) directly in the browser. All your data stays local, the script runs locally, everything stays under your control.</p><p>Have fun Deepesh!</p></div></div><div class=footer><div class=footer-social><span class="social-icon social-icon-twitter"><a href=https://twitter.com/athanazio title=twitter target=_blank rel=noopener><img src=/images/icons/twitter.svg width=24 height=24 alt=twitter></a></span>
<span class="social-icon social-icon-github"><a href=https://github.com/hamilton-lima title=github target=_blank rel=noopener><img src=/images/icons/github.svg width=24 height=24 alt=github></a></span>
<span class="social-icon social-icon-linkedin"><a href=https://www.linkedin.com/in/hamiltonlima title=linkedin target=_blank rel=noopener><img src=/images/icons/linkedin.svg width=24 height=24 alt=linkedin></a></span></div></div></div><script type=text/javascript src=/js/bundle.min.df8701b5f509374aa1fd6b7f39e6100d9eedbb268d023d3bec1a6e8220fd6dee.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-J7T3DC7D47"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-J7T3DC7D47');</script></body></html>