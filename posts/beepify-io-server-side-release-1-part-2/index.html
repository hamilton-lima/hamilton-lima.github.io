<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>beepify.io, server side release 1 - part 2 - Hamilton Lima</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://hamiltonlima.comfavicon.png><link rel=canonical href=https://hamiltonlima.com/posts/beepify-io-server-side-release-1-part-2/><link rel=stylesheet href=/css/style.min.381fd69187be1f5dde5031ac9014016e77965dbc38358cb065b6fede27b5861c.css><link rel=stylesheet href=/assets/css/extended.min.9729f28a5087b689b946e103d96abd63bfd37b1417effa251dbf798312e3fba5.css><meta property="og:title" content="beepify.io, server side release 1 - part 2"><meta property="og:type" content="website"><meta property="og:url" content="https://hamiltonlima.com/posts/beepify-io-server-side-release-1-part-2/"><meta name=twitter:card content="summary"><meta name=twitter:site content="@athanazio"><meta name=twitter:creator content="@athanazio"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel=stylesheet></head><body class="page frame page-blog-single"><div id=menu-main-mobile class=menu-main-mobile><ul class=menu><li class=menu-item-posts><a href=https://hamiltonlima.com/posts>Posts</a></li></ul></div><div id=wrapper class=wrapper><div class=header><a class=header-logo href=/>Hamilton Lima</a><div class=menu-main><ul><li class=menu-item-posts><a href=/posts><span>Posts</span></a></li></ul></div><div id=toggle-menu-main-mobile class=hamburger-trigger><button class=hamburger>Menu</button></div></div><div class=blog><div class=intro><h1>beepify.io, server side release 1 - part 2<span class=dot>.</span></h1></div><div class=content><p>The second part of the server side release 1 will describe some details about the implementation it self. please <a href=https://hamiltonlima.com/blog/beepify-io-server-side-release-1-part1/>see the first part</a> for configuration details.</p><h3 id=quick-tips-to-aplayframework-application>Quick tips to a playframework application</h3><ul><li>Of course there are tons of nice features that can be used, but for the sake of simplicity here are the concepts that I consider the most important ones for this implementation:</li><li>Edit the file <strong>conf/routes</strong> to match the services urls and the implementation of it, as simple as: <strong>GET /mock controllers.MockDataController.add()</strong>, that will publish the url /mock at your application, and when this address is call the method add() from the class MockDataController will be called, and that class is implemented at the folder app/controllers and extends Controller</li><li>Create your model classes, as <a href=https://pt.wikipedia.org/wiki/Plain_Old_Java_Objects>POJO</a> files, make life simple all the attributes can be public, you just need to add the @Entity notation, extend Model class and add @Id notation as well, that will generate the necessary table in the database to store your objects</li><li>Use <a href=https://ebean-orm.github.io/>Ebean</a> to read data from the database, most of the time is very simple and straightforward, for example an simple find by barcode on the Products is written like this:</li></ul><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>     new Model.Finder(Product.class).where().eq(&#34;barcode&#34;, barcode).findUnique();
</code></pre></div><h3 id=declaring-relationship-between-classes>Declaring relationship between classes</h3><p>This is the tables in use for this application <img src=/images/2016/10/beepify-database.png alt=beepify-database> Note that we have some relationships: from Product to Prices, from Prices to Product and from Prices to Store, let´s see how this represented in the Java code. For reference here are the complete java classes :</p><ul><li><a href=/images/2016/10/Price.java_.txt>Price.java</a></li><li><a href=/images/2016/10/Product.java_.txt>Product.java</a></li><li><a href=/images/2016/10/Store.java_.txt>Store.java</a></li></ul><p>At the Product class the relationship with the list of Price is represented by the annotation @OneToMany that indicates the attribute &ldquo;product&rdquo; as the way to map Price to one Product</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>   @OneToMany(mappedBy=&#34;product&#34;)
     public List&lt;Price&gt; prices;
</code></pre></div><p>At the Price class we have counterpart of the relationship represented with the annotation
@ManyToOne</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>@ManyToOne
 @JsonIgnore
 public Product product;
</code></pre></div><blockquote><p>Note that the attribute &ldquo;product&rdquo; also has an annotation @JsonIgnore, that will avoid an infinite recursion when trying to generate an JSON to represent a product. without this instruction the JSON parser would try to read the prices list of the product that is in the price, that would result in a infinite loop (been there done that)</p></blockquote><p>The infinite loop error :) <img src=/images/2016/10/2016-10-16_2006.png alt=2016-10-16_2006> The Controllers On this implementation we have the following urls/controllers GET /products controllers.ProductController.getAll() GET /product/:barcode controllers.ProductController.findByBarcode(barcode: String) GET /mock controllers.MockDataController.add() /products as the name implies read all the existing products, this of course is only usable for tests, imagine a service returning 100k products&mldr; /product/:barcode is an url that accepts one parameter and that parameter will be passed to the method findByBarcode( ), so its possible to make calls like: /product/00000 where 00000 is the barcode of the product to be search. /mock is a service to create the test data used in this implementation. Here are the full source code for each controller, the itself is very simple and straight forward, for example a way to store each Model to the database is calling the method: save(), simple isn´t it ? ;)</p><ul><li><a href=/images/2016/10/ProductController.java_.txt>ProductController.java</a></li><li><a href=/images/2016/10/MockDataController.java_.txt>MockDataController.java</a></li></ul></div></div><div class=footer><div class=footer-social><span class="social-icon social-icon-twitter"><a href=https://twitter.com/athanazio title=twitter target=_blank rel=noopener><img src=/images/icons/twitter.svg width=24 height=24 alt=twitter></a></span>
<span class="social-icon social-icon-github"><a href=https://github.com/hamilton-lima title=github target=_blank rel=noopener><img src=/images/icons/github.svg width=24 height=24 alt=github></a></span>
<span class="social-icon social-icon-linkedin"><a href=https://www.linkedin.com/in/hamiltonlima title=linkedin target=_blank rel=noopener><img src=/images/icons/linkedin.svg width=24 height=24 alt=linkedin></a></span></div></div></div><script type=text/javascript src=/js/bundle.min.df8701b5f509374aa1fd6b7f39e6100d9eedbb268d023d3bec1a6e8220fd6dee.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-J7T3DC7D47"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-J7T3DC7D47');</script></body></html>